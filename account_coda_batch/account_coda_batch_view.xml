<?xml version="1.0" ?>
<openerp>
  <data>

    <!-- CODA Batch Import Configuration -->   
    
    <record id="view_account_coda_batch_config_tree" model="ir.ui.view">
      <field name="name">account.coda.batch.config.tree</field>
      <field name="model">account.coda.batch.config</field>
      <field name="type">tree</field>
      <field name="arch" type="xml">
        <tree string="CODA Batch Import Configuration">
          <field name="directory_id"/>
          <field name="company_id" widget="selection" groups="base.group_multi_company"/>
        </tree>
      </field>
    </record>
    
    <record id="view_account_coda_batch_config_form" model="ir.ui.view">
      <field name="name">account.coda.batch.config.form</field>
      <field name="model">account.coda.batch.config</field>
      <field name="type">form</field>
      <field name="arch" type="xml">
        <form string="CODA Batch Import Configuration">
          <field name="directory_id"/>
          <field name="active"/>
          <field name="company_id" widget="selection" groups="base.group_multi_company"/>
        </form>
      </field>
    </record>
    
    <record id="action_account_coda_batch_config_form" model="ir.actions.act_window">
      <field name="name">CODA Batch Import Configuration</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">account.coda.batch.config</field>
      <field name="view_type">form</field>
      <field name="view_mode">tree,form</field>
    </record>
    
    <menuitem action="action_account_coda_batch_config_form" id="menu_action_account_coda_batch_config_form" parent="account_coda.menu_manage_coda" sequence="50"/>

    <!-- CODA Batch Import Processing -->   
    
    <record id="account_coda_batch_import_view" model="ir.ui.view">
      <field name="name">CODA Batch Import</field>
      <field name="model">account.coda.batch.import</field>
      <field name="type">form</field>
      <field name="priority">1</field>
      <field name="arch" type="xml">
        <form string="CODA Batch Import">
          <group col="2">
            <separator string="Select Folder" colspan="4"/>
            <field name="directory_id"/>
          </group>
          <separator colspan="4"/>
          <group colspan="4">
            <button special="cancel" string="_Cancel" icon="gtk-cancel"/>
            <button name="coda_batch_import" string="_Import" type="object" icon="gtk-ok"/>
          </group>
        </form>
      </field>
    </record>

    <record id="account_coda_batch_import_result_view" model="ir.ui.view">
      <field name="name">CODA Batch Import</field>
      <field name="model">account.coda.batch.import</field>
      <field name="type">form</field>
      <field name="priority">2</field>
      <field name="arch" type="xml">
        <form string="CODA Batch Import">
          <separator colspan="4" string="Results :" />
          <field name="note" colspan="4" nolabel="1" width="850" height="400"/>
          <newline/>
          <separator colspan="6"/>
          <button special="cancel" string="Close" icon="gtk-cancel"/>
          <button name="action_open_log" string="View Batch Import Log" type="object" icon="gtk-apply"/>
        </form>
      </field>
    </record>

    <record id="action_account_coda_batch_import" model="ir.actions.act_window">
      <field name="name">CODA Batch Import</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">account.coda.batch.import</field>
      <field name="view_type">form</field>
      <field name="view_mode">form</field>
      <field name="target">new</field>
      <field name="view_id" ref="account_coda_batch_import_view"/>
    </record>

    <menuitem name="Batch Import CODA Files" parent="account_coda.menu_account_coda" id="menu_account_coda_batch_import" action="action_account_coda_batch_import" sequence="50"/>

    <act_window name="Batch Import CODA Files"
      res_model="account.coda.batch.import"
      src_model="account.coda.batch.log"
      view_type="form" view_mode="form" target="new"
      key2="client_action_multi" multi="True"
      id="action_multi_account_coda_batch_import"/>    
    
    <!-- CODA Batch Import Logs -->

    <record model="ir.ui.view" id="view_account_coda_batch_log_tree">
      <field name="name">account.coda.batch.log.tree</field>
      <field name="model">account.coda.batch.log</field>
      <field name="type">tree</field>
      <field name="arch" type="xml">
        <tree string="CODA Batch Import Logs">
          <field name="name"/>
          <field name="directory_id"/>
          <field name="date"/>
          <field name="user_id"/>
          <field name="state"/>
          <field name="company_id" widget="selection" groups="base.group_multi_company"/>          
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="view_account_coda_batch_log_form">
      <field name="name">account.coda.batch.log.form</field>
      <field name="model">account.coda.batch.log</field>
      <field name="type">form</field>
      <field name="arch" type="xml">
        <form string="CODA Batch Import Log">
          <group>
            <field name="name"/>
            <field name="directory_id"/>
            <field name="date"/>
            <field name="user_id"/>
            <field name="company_id" widget="selection" groups="base.group_multi_company"/>
          </group>
          <separator colspan="4" string="CODA Batch Import Log"/>
          <field name="note" nolabel="1" colspan="4" />
          <separator colspan="4"/>
          <group col="5" colspan="4">
            <field name="state"/>
            <button name="button_cancel" states="done,error" string="Cancel" type="object" icon="gtk-cancel"/>
            <button name="button_import" states="draft,error" string="Restart Import" type="object" icon="gtk-go-forward"/>
            <button name="button_done" states="draft,error" string="Mark Done" type="object"  icon="terp-camera_test"/>
          </group>
        </form>
      </field>
    </record>
    
    <record id="view_account_coda_batch_log_search" model="ir.ui.view">
      <field name="name">account.coda.batch.log.search</field>
      <field name="model">account.coda.batch.log</field>
      <field name="type">search</field>
      <field name="arch" type="xml">
        <search string="Search CODA Batch Import Log Files">
          <group col="10" colspan="4">
            <field name="name"/>
            <field name="directory_id"/>
            <field name="state"/>
            <field name="user_id" widget="selection"/>
          </group>
          <newline/>
          <group expand="0" string="Group By...">
            <filter string="State" icon="terp-stock_effects-object-colorize" context="{'group_by':'state'}"/>
            <filter string="User" icon="terp-personal" domain="[]"  context="{'group_by':'user_id'}"/>
            <separator orientation="vertical"/>
            <filter string="Company" icon="terp-go-home" domain="[]" groups="base.group_multi_company" context="{'group_by':'company_id'}"/>
          </group>
        </search>
      </field>
    </record>
    
    <record model="ir.actions.act_window" id="action_account_coda_batch_log_files">
      <field name="name">CODA Batch Import Logs</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">account.coda.batch.log</field>
      <field name="view_type">form</field>
      <field name="view_mode">tree,form</field>
      <field name="view_id" ref="view_account_coda_batch_log_tree"/>
      <field name="search_view_id" ref="view_account_coda_batch_log_search"/>
    </record>

    <menuitem name="CODA Batch Import Logs" parent="account_coda.menu_account_coda" id="menu_account_coda_batch_log_files" action="action_account_coda_batch_log_files"  sequence="51"/>

  </data>
</openerp>
